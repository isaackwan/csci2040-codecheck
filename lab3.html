<!DOCTYPE HTML>
<html>
<head>
	<script src="lib/brython.js"></script>
	<script src="lib/brython_stdlib.js"></script>
</head>
<body onload="brython()">
	<script type="text/python" src="py3/lab3.py"></script>
	<input id="zone"><button id="mybutton">click !</button>
	<div id="drop_zone" style="background-color: grey; min-height: 3em;">Hello!</div>
	<script type="text/javascript">
		document.getElementById("drop_zone").addEventListener("dragover", function(e){
			e.stopPropagation();
			e.preventDefault();
			e.dataTransfer.dropEffect = "copy";
		});
		document.getElementById("drop_zone").addEventListener("drop", function(e) {
			e.stopPropagation();
			e.preventDefault();
			console.debug(e.dataTransfer.files);
			var files = Array.from(e.dataTransfer.files);
			files = files.map((file) => new Promise((resolve, reject) => {
				const reader = new FileReader();
				reader.onload = (e) => {
					resolve({name: file.name, body: e.target.result});
				};
				reader.onerror = (e) => {
					reject({event: e});
				}
				reader.readAsText(file)
			}));
			console.debug(files);
			Promise.all(files).then((x) => console.debug(x));
		});
	</script>
</body>
</html>
